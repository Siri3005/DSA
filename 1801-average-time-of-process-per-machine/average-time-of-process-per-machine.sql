Select s.machine_id,Round(Avg(e.timestamp-s.timestamp),3) processing_time from Activity s JOIN Activity e on s.machine_id=e.machine_id AND s.process_id=e.process_id and s.activity_type='start' AND e.activity_type='end' GROUP BY s.machine_id